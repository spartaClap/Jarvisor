<!DOCTYPE html>
<html>
  <head>
    <!-- html 기본 -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- 부트스트랩 연결 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <!-- ajax 연결 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- js 연결-->
    <script src="canvas3.js"></script>

    <title>모두의 회의 비서 Jarvisor</title>

  </head>
  <body>
    <header>
      <nav class="navbar navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Jarvisor</a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasDarkNavbar"
            aria-controls="offcanvasDarkNavbar"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <!--메뉴버튼-->
          <div
            class="offcanvas offcanvas-end text-bg-dark"
            tabindex="-1"
            id="offcanvasDarkNavbar"
            aria-labelledby="offcanvasDarkNavbarLabel"
          >
            <div class="offcanvas-header">
              <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">
                Jarvisor
              </h5>
              <button
                type="button"
                class="btn-close btn-close-white"
                data-bs-dismiss="offcanvas"
                aria-label="Close"
              ></button>
            </div>
            <div class="offcanvas-body">
              <a onclick="location.href='loginIndex.html'">마이페이지</a>
              <a onclick="">내보내기</a>
              <a onclick="">로그아웃</a>
            </div>
          </div>
        </div>
      </nav>
    </header>
    <main>
      <!--캔버스이동메뉴-->
      <div class="menubar" style="background-color: rgb(0, 0, 0)">
        <p>zz<br />zz</p>
        <ul class="nav nav-pills nav-fill">
          <li class="nav-item">
            <a class="nav-link" href="/canvas1">canvas1</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">canvas2</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/canvas3">canvas3</a>
          </li>
        </ul>
      </div>
      <!--페이지이동버튼-->
      <div>
        <nav aria-label="...">
          <ul class="pagination pagination-sm">
            <li class="page-item active" aria-current="page">
              <span class="page-link">1</span>
            </li>
            <li class="page-item"><a class="page-link" href="#">2</a></li>
            <li class="page-item"><a class="page-link" href="#">3</a></li>
          </ul>
        </nav>
      </div>
      <!--토픽-->
      <div>
        <style>
          #topic_change {display: none;}
        </style>

        <script>
          function open_box() {
            $("#topic_change").show();
          }
          function close_box() {
            $("#topic_change").hide();
          }
          function input_topic() {
            const newTopic = document.getElementById('newTopic').value;
            document.getElementById("topic").innerText = newTopic;
          }
        </script>

        <button id="topic" onclick="open_box()">토픽을 입력하세요</button>
        <div id="topic_change">
            <input id='newTopic' type="text">
            <button class="btn btn-outline-secondary" type="button" onclick="close_box()">닫기</button>
            <button class="btn btn-outline-secondary" type="button" onclick="input_topic(), close_box()">저장</button>
        </div>
      </div>
      <!--컨텐츠 (회의내용)-->
      <div>
        <style>
          #add_contents {display: none;}
        </style>

        <script>
          $(document).ready(function(){
              show_contents()
          });
          function open_contents() {
            $("#add_contents").show();
          }
          function close_contents() {
            $("#add_contents").hide();
          }
          function add_contents() {
            const name = document.getElementById('name').value;
            const summary = document.getElementById('summary').value;
            const comment = document.getElementById('comment').value;
            let temp_html = `
                <input type="text" value="${name}" readonly>
                <input type="text" value="${summary}" readonly>
                <input type="text" value="${comment}" readonly>
              `
            $('#contents').append(temp_html)
          }
          
          // DB 연동 함수
          function save_contents(){
              let name = $('#name').val()
              let summary = $('#summary').val()
              let comment = $('#comment').val()

              $.ajax({
                  type: 'POST',
                  url: '/bstorming',
                  data: {name_give: name, summary_give: summary, comment_give: comment},
                  success: function (response) {
                      alert(response['msg'])
                      window.location.reload()
                  }
              })
          }



          function show_contents(){
            $.ajax({
                type: 'GET',
                url: '/bstorming',
                data: {},
                success: function (response) {
                    let rows = response['bstorming']
                    for (let i = 0; i < rows.length; i++) {
                        let name = rows[i]['name']
                        let summary = rows[i]['summary']
                        let comment = rows[i]['comment']

                        let temp_html = `
                                          <input type="text" value="${name}" readonly>
                                          <input type="text" value="${summary}" readonly>
                                          <input type="text" value="${comment}" readonly>
                                        `
                        $('#contents').append(temp_html)
                    }
                }
            });
        }

        </script>
        <div id="contents">
          <input type="text" id="name" required placeholder="이름">
          <input type="text" id="summary" required placeholder="내용">
          <input type="text" id="comment" placeholder="코멘트">
        </div>
        <button id="btn_add" onclick="open_contents()">추가</button>
        <div id="add_contents">
          <div>
            <input type="text" id='name' required placeholder="이름">
            <input type="text" id='summary' required placeholder="내용">
            <input type="text" id='comment' placeholder="코멘트">
          </div>
          <button type="button" onclick="add_contents(), close_contents(), save_contents(), show_contents()">저장</button>
        </div>
      </div>
    </main>
  </body>
</html>
